{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Drew/Projects/bakers-math-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/Drew/Projects/bakers-math-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/Drew/Projects/bakers-math-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/Drew/Projects/bakers-math-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback}from\"react\";import config from\"../../Config\";// import { useAuth0 } from \"@auth0/auth0-react\";\nexport var API_SAVE=function API_SAVE(formData,endpointSuffix,rowId){var _useState=useState({formData:null,isSaving:false,saveSuccessful:false,saveError:\"\"}),_useState2=_slicedToArray(_useState,2),resSave=_useState2[0],setRes=_useState2[1];//   const { getAccessTokenSilently } = useAuth0();\nvar saveMethod;//   const { user } = useAuth0();\n//   const userId = user.sub.split(\"|\")[1];\n//   let url = `${config.API_ENDPOINT}/${endpointSuffix}/${userId}`;\nvar url=\"\".concat(config.API_ENDPOINT,\"/\").concat(endpointSuffix);if(rowId===\"new\"){saveMethod=\"POST\";}else{saveMethod=\"PATCH\";url=\"\".concat(url,\"/\").concat(rowId);}var saveData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setRes(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isSaving:true});});_context.prev=1;//   const token = await getAccessTokenSilently();\ntoken=process.env.REACT_APP_API_KEY;console.log(formData,saveMethod);_context.next=6;return fetch(url,{method:saveMethod,body:JSON.stringify(formData),headers:{Authorization:\"Bearer \".concat(token),\"Content-Type\":\"application/json\"}});case 6:result=_context.sent;if(result.ok)setRes(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isSaving:false,saveSuccessful:true,saveError:\"\"});});else if(!result.ok){setRes(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isSaving:false,saveSuccessful:false,saveError:\"Failed to save.\"});});}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);setRes(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isSaving:false,saveSuccessful:false,saveError:\"Failed to save.\"});});case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);})),[formData,saveMethod,url]);//   }, [formData, saveMethod, getAccessTokenSilently, url]);\nreturn[resSave,saveData];};","map":{"version":3,"sources":["/Users/Drew/Projects/bakers-math-client/src/Utilities/APImethods/API_SAVE.js"],"names":["useState","useCallback","config","API_SAVE","formData","endpointSuffix","rowId","isSaving","saveSuccessful","saveError","resSave","setRes","saveMethod","url","API_ENDPOINT","saveData","prevState","token","process","env","REACT_APP_API_KEY","console","log","fetch","method","body","JSON","stringify","headers","Authorization","result","ok"],"mappings":"onBAAA,OAASA,QAAT,CAAmBC,WAAnB,KAAsC,OAAtC,CACA,MAAOC,CAAAA,MAAP,KAAmB,cAAnB,CACA;AAEA,MAAO,IAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,QAAD,CAAWC,cAAX,CAA2BC,KAA3B,CAAqC,eACjCN,QAAQ,CAAC,CACjCI,QAAQ,CAAE,IADuB,CAEjCG,QAAQ,CAAE,KAFuB,CAGjCC,cAAc,CAAE,KAHiB,CAIjCC,SAAS,CAAE,EAJsB,CAAD,CADyB,wCACpDC,OADoD,eAC3CC,MAD2C,eAQ3D;AAEA,GAAIC,CAAAA,UAAJ,CACA;AACA;AAEA;AACA,GAAIC,CAAAA,GAAG,WAAMX,MAAM,CAACY,YAAb,aAA6BT,cAA7B,CAAP,CACA,GAAIC,KAAK,GAAK,KAAd,CAAqB,CACnBM,UAAU,CAAG,MAAb,CACD,CAFD,IAEO,CACLA,UAAU,CAAG,OAAb,CACAC,GAAG,WAAMA,GAAN,aAAaP,KAAb,CAAH,CACD,CAED,GAAMS,CAAAA,QAAQ,CAAGd,WAAW,sEAAC,oJAC3BU,MAAM,CAAC,SAACK,SAAD,wCAAqBA,SAArB,MAAgCT,QAAQ,CAAE,IAA1C,IAAD,CAAN,CAD2B,gBAGzB;AACMU,KAJmB,CAIXC,OAAO,CAACC,GAAR,CAAYC,iBAJD,CAKzBC,OAAO,CAACC,GAAR,CAAYlB,QAAZ,CAAsBQ,UAAtB,EALyB,sBAOJW,CAAAA,KAAK,CAACV,GAAD,CAAM,CAC9BW,MAAM,CAAEZ,UADsB,CAE9Ba,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAevB,QAAf,CAFwB,CAG9BwB,OAAO,CAAE,CACPC,aAAa,kBAAYZ,KAAZ,CADN,CAEP,eAAgB,kBAFT,CAHqB,CAAN,CAPD,QAOnBa,MAPmB,eAezB,GAAIA,MAAM,CAACC,EAAX,CACEpB,MAAM,CAAC,SAACK,SAAD,wCACFA,SADE,MAELT,QAAQ,CAAE,KAFL,CAGLC,cAAc,CAAE,IAHX,CAILC,SAAS,CAAE,EAJN,IAAD,CAAN,CADF,IAOK,IAAI,CAACqB,MAAM,CAACC,EAAZ,CAAgB,CACnBpB,MAAM,CAAC,SAACK,SAAD,wCACFA,SADE,MAELT,QAAQ,CAAE,KAFL,CAGLC,cAAc,CAAE,KAHX,CAILC,SAAS,CAAE,iBAJN,IAAD,CAAN,CAMD,CA7BwB,iFA+BzBE,MAAM,CAAC,SAACK,SAAD,wCACFA,SADE,MAELT,QAAQ,CAAE,KAFL,CAGLC,cAAc,CAAE,KAHX,CAILC,SAAS,CAAE,iBAJN,IAAD,CAAN,CA/ByB,qEAAD,GAsCzB,CAACL,QAAD,CAAWQ,UAAX,CAAuBC,GAAvB,CAtCyB,CAA5B,CAuCA;AACA,MAAO,CAACH,OAAD,CAAUK,QAAV,CAAP,CACD,CAhEM","sourcesContent":["import { useState, useCallback } from \"react\";\nimport config from \"../../Config\";\n// import { useAuth0 } from \"@auth0/auth0-react\";\n\nexport const API_SAVE = (formData, endpointSuffix, rowId) => {\n  const [resSave, setRes] = useState({\n    formData: null,\n    isSaving: false,\n    saveSuccessful: false,\n    saveError: \"\",\n  });\n\n  //   const { getAccessTokenSilently } = useAuth0();\n\n  let saveMethod;\n  //   const { user } = useAuth0();\n  //   const userId = user.sub.split(\"|\")[1];\n\n  //   let url = `${config.API_ENDPOINT}/${endpointSuffix}/${userId}`;\n  let url = `${config.API_ENDPOINT}/${endpointSuffix}`;\n  if (rowId === \"new\") {\n    saveMethod = \"POST\";\n  } else {\n    saveMethod = \"PATCH\";\n    url = `${url}/${rowId}`;\n  }\n\n  const saveData = useCallback(async () => {\n    setRes((prevState) => ({ ...prevState, isSaving: true }));\n    try {\n      //   const token = await getAccessTokenSilently();\n      const token = process.env.REACT_APP_API_KEY;\n      console.log(formData, saveMethod);\n\n      const result = await fetch(url, {\n        method: saveMethod,\n        body: JSON.stringify(formData),\n        headers: {\n          Authorization: `Bearer ${token}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n      if (result.ok)\n        setRes((prevState) => ({\n          ...prevState,\n          isSaving: false,\n          saveSuccessful: true,\n          saveError: \"\",\n        }));\n      else if (!result.ok) {\n        setRes((prevState) => ({\n          ...prevState,\n          isSaving: false,\n          saveSuccessful: false,\n          saveError: \"Failed to save.\",\n        }));\n      }\n    } catch (error) {\n      setRes((prevState) => ({\n        ...prevState,\n        isSaving: false,\n        saveSuccessful: false,\n        saveError: \"Failed to save.\",\n      }));\n    }\n  }, [formData, saveMethod, url]);\n  //   }, [formData, saveMethod, getAccessTokenSilently, url]);\n  return [resSave, saveData];\n};\n"]},"metadata":{},"sourceType":"module"}